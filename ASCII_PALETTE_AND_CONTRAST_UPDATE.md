# ASCII Палитра и Контраст - Обновление ✅

## Что изменено:

### 1. ✅ Новая упорядоченная ASCII палитра (10 символов)

**Старая палитра**: 70+ символов (слишком много, сложная)

**Новая палитра**: 10 символов, упорядочены для темных → светлых областей ИЗОБРАЖЕНИЯ
```
 .:=-+*#%@
```

**Объяснение порядка (для областей изображения):**
- ` ` (пробел) - темная область изображения → незаметный символ
- `.` - темная область → еле заметная точка
- `:` - темновато → легкая точка
- `=` - ниже среднего
- `-` - средняя яркость
- `+` - выше среднего
- `*` - светлая область → заметный символ
- `#` - очень светлая область → акцентный символ
- `%` - яркая область → сильно акцентный
- `@` - самая светлая область изображения → максимально заметный символ

**Логика**: Темные части изображения (тени) отображаются пробелами/точками (незаметно), светлые части (блики) отображаются @, %, # (заметно).

**Преимущества:**
- ✅ Простая и понятная градация
- ✅ Каждый символ имеет четкую яркость
- ✅ Легко читается и понимается
- ✅ Хорошо работает на всех устройствах

---

### 2. ✅ SOFTY → Регулировка КОНТРАСТА (вместо блюра!)

**Было**: SOFTY применял Box Blur для размытия изображения

**Стало**: SOFTY регулирует **КОНТРАСТ** изображения

#### Как работает контраст:

**Формула**: `(value - 128) × factor + 128`

- Центрируем яркость вокруг серого (128)
- Умножаем на фактор контраста
- Возвращаем обратно

**Диапазоны:**
- **SOFTY = 0**: factor = 1.0 → без изменений (оригинальный контраст)
- **SOFTY = 50**: factor = 1.75 → умеренное усиление контраста
- **SOFTY = 100**: factor = 2.5 → максимальный контраст (темные темнее, светлые светлее)

**Эффект:**
- Темные области становятся **еще темнее** → символы `@`, `%`, `#`
- Светлые области становятся **еще светлее** → символы `.`, пробел
- Средние тона **растягиваются** → больше диапазон между темным и светлым
- Изображение становится **более четким и выразительным**

---

## Технические детали:

### Изменения в коде:

#### 1. `ASCIIEngineV2.kt` - Палитра (строка 49)
```kotlin
// Было:
private const val ASCII_RICH = " .'`^\",:;Il!i><~+_-?][}{1)(|\\/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$"

// Стало (ПЕРЕВЕРНУТО для правильного отображения):
private const val ASCII_ORDERED = " .:=-+*#%@"
// Темные области изображения → пробел, точка (незаметные)
// Светлые области изображения → @, %, # (заметные)
```

#### 2. `ASCIIEngineV2.kt` - Контраст вместо блюра (строки 257-295)
```kotlin
// Было:
fun luminanceGrid(
    bitmap: Bitmap,
    cols: Int,
    rows: Int,
    blur: Int = 0,  // ← применял Box Blur
    gamma: Float = 1.2f
)

// Стало:
fun luminanceGrid(
    bitmap: Bitmap,
    cols: Int,
    rows: Int,
    contrast: Int = 0,  // ← регулирует контраст!
    gamma: Float = 1.2f
)
```

#### 3. Формула контраста:
```kotlin
val contrastFactor = 1.0f + (contrast / 100f) * 1.5f
v = (((v - 128) * contrastFactor) + 128).toInt().coerceIn(0, 255)
```

---

## Как использовать:

### В UI:

**CELL** (0-100):
- 0% → минимум символов (быстро)
- 50% → средняя детализация
- 100% → максимум символов (~173x173 = 30k)

**JITTER** (0-100):
- 0% → статичное изображение
- 50% → легкая анимация
- 100% → активная анимация (±3 индекса)

**SOFTY** (теперь КОНТРАСТ!) (0-100):
- 0% → оригинальный контраст
- 50% → умеренное усиление (factor=1.75)
- 100% → максимальный контраст (factor=2.5)

---

## Сравнение результатов:

### Без контраста (SOFTY=0):
```
Темная область изображения (яркость 50) → символ "." или ":"
Средняя яркость (яркость 128) → символ "-" или "="
Светлая область (яркость 200) → символ "#" или "%"
```

### С максимальным контрастом (SOFTY=100):
```
Темная область (яркость 50) → ((50-128) × 2.5 + 128) = 33 → еще темнее → символ " " (пробел)
Средняя яркость (яркость 128) → без изменений → символ "-"
Светлая область (яркость 200) → ((200-128) × 2.5 + 128) = 308 → 255 → еще светлее → символ "@"
```

**Результат**: 
- **Темные части изображения** (тени, волосы) → пробелы ` ` (почти невидимы)
- **Светлые части** (блики, освещенные области) → `@`, `%`, `#` (сильно заметны)
- Изображение становится **более контрастным и выразительным**!

---

## Что теперь работает:

✅ **ASCII с 10 четкими градациями** ` .:=-+*#%@`  
✅ **Правильный порядок**: темные области изображения → пробелы/точки, светлые → @, %, #  
✅ **SOFTY регулирует контраст** (не блюр!)  
✅ **Темные части изображения (тени)** отображаются незаметными символами  
✅ **Светлые части (блики)** отображаются акцентными символами  
✅ **Изображение более четкое и выразительное**  
✅ **Простая и понятная палитра символов**  

---

## Тестирование:

1. Запустите приложение
2. Выберите **ASCII эффект**
3. **CELL = 50-100%** для хорошей детализации
4. **SOFTY = 0%** → оригинальное изображение
5. **SOFTY = 50-100%** → контрастное, четкое изображение

Вы должны увидеть:
- При низком SOFTY: мягкое изображение с плавными переходами
- При высоком SOFTY: контрастное изображение с четкими темными и светлыми областями
- **Темные части изображения** (тени, волосы, темный фон) → пробелы ` `, точки `.`, `:`
- **Светлые части изображения** (лицо при свете, блики) → `@`, `%`, `#`, `*`

🚀 **Готово к использованию!**

